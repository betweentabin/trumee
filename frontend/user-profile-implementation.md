# ユーザープロフィールページ実装計画

## 現状分析

### 既存のユーザー関連ページ
- `/users/page.tsx` - 静的なマイページ（山田太郎さん固定）
- `/users/myinfo/*` - ユーザー情報管理ページ群
- `/seeker/dashboard` - 求職者ダッシュボード
- `/company/dashboard` - 企業ダッシュボード

### 課題
現在のusersページは静的で、個別ユーザーのプロフィールページが存在しない

## 実装要件

### 1. 動的ユーザープロフィールページ
**パス**: `/users/[userId]/page.tsx`

#### 機能要件
- ユーザーIDに基づいた個別プロフィール表示
- 公開/非公開情報の適切な表示制御
- 自分のプロフィール vs 他人のプロフィールの表示分岐

#### 表示情報
**公開情報（誰でも閲覧可能）**:
- 名前（または表示名）
- プロフィール画像
- 自己紹介
- スキルセット
- 公開履歴書（is_activeがtrueのもの）
- 希望職種・業界（公開設定の場合）

**非公開情報（本人のみ閲覧可能）**:
- メールアドレス
- 電話番号
- 詳細な個人情報
- 非公開履歴書
- 応募履歴
- スカウト受信履歴

### 2. API要件

#### 必要なAPIエンドポイント
```typescript
// ユーザープロフィール取得
GET /api/v2/users/{userId}
Response: {
  id: string;
  email?: string; // 本人のみ
  full_name: string;
  profile_image?: string;
  bio?: string;
  skills: string[];
  desired_job?: string;
  desired_industries?: string[];
  is_public: boolean;
  resumes?: Resume[]; // 公開履歴書のみ
  created_at: string;
  updated_at: string;
}

// プロフィール更新
PATCH /api/v2/users/{userId}
Body: Partial<UserProfile>
```

### 3. コンポーネント構成

```
/users/[userId]/
├── page.tsx              # メインページ
├── ProfileHeader.tsx     # プロフィールヘッダー
├── ProfileInfo.tsx       # 基本情報表示
├── SkillSection.tsx      # スキル表示
├── ResumeSection.tsx     # 履歴書一覧
└── EditProfileModal.tsx  # プロフィール編集モーダル
```

### 4. 実装ステップ

#### Step 1: ルーティング設定
- `/users/[userId]/page.tsx` の作成
- 動的ルーティングの実装

#### Step 2: API統合
- ユーザープロフィール取得API実装
- 認証チェックと権限制御

#### Step 3: UIコンポーネント実装
- プロフィールヘッダー
- 情報表示セクション
- 編集機能（本人のみ）

#### Step 4: プライバシー制御
- 公開/非公開設定の実装
- 表示権限のチェック

### 5. セキュリティ考慮事項

- **認証チェック**: 非公開情報へのアクセス制御
- **CSRF対策**: プロフィール更新時のトークン検証
- **データバリデーション**: 入力値の検証
- **レート制限**: API呼び出しの制限

### 6. UI/UXデザイン

#### レイアウト
```
┌─────────────────────────────────────┐
│      プロフィール画像 | 名前         │
│      自己紹介文                     │
├─────────────────────────────────────┤
│ スキル                              │
│ ・React ・TypeScript ・Node.js      │
├─────────────────────────────────────┤
│ 公開履歴書                          │
│ ・エンジニア向け履歴書              │
│ ・マーケティング向け履歴書          │
└─────────────────────────────────────┘
```

#### 編集モード（本人のみ）
- インライン編集
- モーダルダイアログでの詳細編集
- リアルタイムプレビュー

### 7. 既存ページとの統合

- `/users/page.tsx` → リダイレクト to `/users/[currentUserId]`
- ナビゲーションリンクの更新
- ダッシュボードからのリンク追加

### 8. テスト要件

- ユニットテスト: 各コンポーネント
- 統合テスト: API連携
- E2Eテスト: ユーザーフロー
- セキュリティテスト: 権限チェック

## 実装優先順位

1. **高**: 基本的なプロフィール表示
2. **高**: 認証と権限制御
3. **中**: プロフィール編集機能
4. **中**: 履歴書表示
5. **低**: 詳細な統計情報表示